git config pull.ff only
# For R/4.4.0}
# install.packages("htmlwidgets")
# install.packages("devtools")
library(devtools)
# install_version("apTreeshape", version = "1.5-0.1")
library(apTreeshape)
# install_version("treeducken", version = "1.1.0")
library(treeducken)
library(phytools)
set.seed(54)
# host speciation
lambda_H <- rexp(n=1)
# host extinction fraction
mu_H <- 0.3
# cospeciation
lambda_C <- rexp(n=1)
# time
time <- 2
# symbiont speciation
lambda_S <- rexp(n=1)
# symbiont extinction fraction
mu_S <- 0.3
lambda_total_H <- lambda_H + lambda_C
lambda_total_S <- lambda_S + lambda_C
# calculate the expected number of tips for the host and symbiont trees
H_tips <- ave_tips_st(lambda = lambda_total_H, mu = mu_H, t = time)
S_tips <- ave_tips_st(lambda = lambda_total_S, mu = mu_S, t = time)
cophy_obj <- sim_cophyBD(hbr = lambda_H,
hdr = mu_H,
sbr = lambda_S,
sdr = mu_S,
cosp_rate =lambda_C,
host_exp_rate = 0.0,
time_to_sim = time,
numbsim = 1)
# visualization using treeDucken, with imperfections
plot.cophy(cophy_obj[[1]], col = "orange", lty = "dotted", lwd = 2)
# visualization using ape or phytools, transformation of the association matrix needed
ass_mat_trans <- NULL
ass_mat <- cophy_obj[[1]][[3]]
for(i in 1:nrow(ass_mat)){
for (j in 1:ncol(ass_mat)){
if (ass_mat[i,j] == 1)
ass_mat_trans <- rbind(ass_mat_trans, c(rownames(ass_mat)[i], colnames(ass_mat)[j]))
}
}
# using ape / phytools
cophylo_plot <- cophylo(cophy_obj[[1]][[1]], cophy_obj[[1]][[2]], assoc = ass_mat_trans)
plot(cophylo_plot)
plot(cophylo_plot,link.type="curved",link.lwd=4,
link.lty="solid",link.col=make.transparent("red",
0.25))
par(mar=c(5.1,4.1,4.1,2.1))
